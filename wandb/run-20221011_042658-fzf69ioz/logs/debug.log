2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_setup.py:_flush():75] Loading settings from /root/.config/wandb/settings
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_setup.py:_flush():75] Loading settings from wandb/settings
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_setup.py:_flush():75] Loading settings from environment variables: {'project': 'meme_experiments', 'entity': 'vietnguyen', 'root_dir': '/content/SSLMemes', 'sweep_id': '99bwrt1n', 'run_id': 'fzf69ioz', 'sweep_param_path': '/content/SSLMemes/wandb/sweep-99bwrt1n/config-fzf69ioz.yaml'}
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_setup.py:_flush():75] Inferring run settings from compute environment: {'program_relpath': 'src/train.py', 'program': '/content/SSLMemes/src/train.py'}
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_init.py:_log_setup():405] Logging user logs to /content/SSLMemes/wandb/run-20221011_042658-fzf69ioz/logs/debug.log
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_init.py:_log_setup():406] Logging internal logs to /content/SSLMemes/wandb/run-20221011_042658-fzf69ioz/logs/debug-internal.log
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_init.py:init():439] calling init triggers
2022-10-11 04:26:58,019 INFO    Thread-2  :28520 [wandb_init.py:init():443] wandb.init called with sweep_config: {'batch_size': 40, 'dropout': 0.5, 'epochs': 1, 'hidden_size': 256, 'learning_rate': 0.0517719098226206, 'optimizer': 'sgd'}
config: {}
2022-10-11 04:26:58,020 INFO    Thread-2  :28520 [wandb_init.py:init():492] starting backend
2022-10-11 04:26:58,020 INFO    Thread-2  :28520 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-10-11 04:26:58,036 INFO    Thread-2  :28520 [backend.py:ensure_launched():219] starting backend process...
2022-10-11 04:26:58,050 INFO    Thread-2  :28520 [backend.py:ensure_launched():225] started backend process with pid: 28553
2022-10-11 04:26:58,052 INFO    Thread-2  :28520 [wandb_init.py:init():501] backend started and connected
2022-10-11 04:26:58,061 INFO    Thread-2  :28520 [wandb_run.py:_config_callback():992] config_cb None None {'batch_size': 40, 'dropout': 0.5, 'epochs': 1, 'hidden_size': 256, 'learning_rate': 0.0517719098226206, 'optimizer': 'sgd'}
2022-10-11 04:26:58,064 INFO    Thread-2  :28520 [wandb_init.py:init():565] updated telemetry
2022-10-11 04:26:58,096 INFO    Thread-2  :28520 [wandb_init.py:init():596] communicating run to backend with 30 second timeout
2022-10-11 04:26:59,067 INFO    Thread-2  :28520 [wandb_run.py:_on_init():1759] communicating current version
2022-10-11 04:26:59,110 INFO    Thread-2  :28520 [wandb_run.py:_on_init():1763] got version response upgrade_message: "wandb version 0.13.4 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2022-10-11 04:26:59,110 INFO    Thread-2  :28520 [wandb_init.py:init():625] starting run threads in backend
2022-10-11 04:27:02,144 INFO    Thread-2  :28520 [wandb_run.py:_console_start():1733] atexit reg
2022-10-11 04:27:02,144 INFO    Thread-2  :28520 [wandb_run.py:_redirect():1606] redirect: SettingsConsole.REDIRECT
2022-10-11 04:27:02,145 INFO    Thread-2  :28520 [wandb_run.py:_redirect():1611] Redirecting console.
2022-10-11 04:27:02,146 ERROR   Thread-2  :28520 [wandb_run.py:_redirect():1670] Failed to redirect.
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/wandb_run.py", line 1663, in _redirect
    out_redir.install()
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/lib/redirect.py", line 709, in install
    _WSCH.add_fd(self._pipe_read_fd)
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/lib/redirect.py", line 659, in add_fd
    self._register()
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/lib/redirect.py", line 644, in _register
    old_handler = signal.signal(signal.SIGWINCH, lambda *_: None)
  File "/usr/lib/python3.7/signal.py", line 47, in signal
    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))
ValueError: signal only works in main thread
2022-10-11 04:27:02,147 INFO    Thread-2  :28520 [wandb_init.py:init():664] run started, returning control to user process
2022-10-11 04:27:02,148 INFO    Thread-2  :28520 [wandb_run.py:_config_callback():992] config_cb None None {'img_feature_path': 'data/features/visualbert/', 'train_csv_path': 'data/splits/random/memotion_train.csv', 'val_csv_path': 'data/splits/random/memotion_val.csv', 'model_type': 'visualbert', 'model_path': 'uclanlp/visualbert-nlvr2-coco-pre', 'epoch': 100, 'eval_step': 100, 'amp': True, 'output_dir': './tmp', 'checkpoint_step': 100, 'random_seed': 42, 'resume_training': False, 'semi_supervised': True}
2022-10-11 04:27:02,522 INFO    Thread-2  :28520 [wandb_run.py:_config_callback():992] config_cb None None {'output_hidden': 768}
2022-10-11 04:27:08,915 INFO    Thread-2  :28520 [wandb_run.py:finish():1539] finishing run vietnguyen/meme_experiments/fzf69ioz
2022-10-11 04:27:08,916 INFO    Thread-2  :28520 [wandb_run.py:_atexit_cleanup():1702] got exitcode: 1
2022-10-11 04:27:08,918 INFO    Thread-2  :28520 [wandb_run.py:_restore():1674] restore
2022-10-11 04:27:08,926 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 699
  total_bytes: 699
}

2022-10-11 04:27:09,121 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 699
  total_bytes: 699
}

2022-10-11 04:27:10,103 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 2
}
pusher_stats {
  uploaded_bytes: 699
  total_bytes: 8754
}

2022-10-11 04:27:10,205 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 699
  total_bytes: 10132
}

2022-10-11 04:27:10,308 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 699
  total_bytes: 10132
}

2022-10-11 04:27:10,410 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}

2022-10-11 04:27:10,513 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}

2022-10-11 04:27:10,615 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}

2022-10-11 04:27:10,717 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}

2022-10-11 04:27:10,819 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}

2022-10-11 04:27:11,278 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}

2022-10-11 04:27:11,640 INFO    Thread-2  :28520 [wandb_run.py:_on_finish():1831] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 4
}
pusher_stats {
  uploaded_bytes: 10132
  total_bytes: 10132
}
local_info {
}

2022-10-11 04:27:12,745 INFO    Thread-2  :28520 [wandb_run.py:_restore():1674] restore
2022-10-11 04:27:12,745 ERROR   Thread-2  :28520 [wandb_run.py:_atexit_cleanup():1723] Problem finishing run
Traceback (most recent call last):
  File "/content/SSLMemes/src/train.py", line 160, in train
    train_loader, val_loader = create_loaders(config,model_type,processor,tokenizer)
  File "/content/SSLMemes/src/utils.py", line 48, in create_loaders
    supervise = not cfg.semi_supervised,model_type=model_type, vilt_processor=processor,mode='train')
  File "/content/SSLMemes/src/data.py", line 54, in __init__
    self.labeled_ids = pd.read_csv(labeled_id_path)["labeled_id"].tolist()
  File "/usr/local/lib/python3.7/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/parsers/readers.py", line 586, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/parsers/readers.py", line 482, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/parsers/readers.py", line 811, in __init__
    self._engine = self._make_engine(self.engine)
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/parsers/readers.py", line 1040, in _make_engine
    return mapping[engine](self.f, **self.options)  # type: ignore[call-arg]
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/parsers/c_parser_wrapper.py", line 51, in __init__
    self._open_handles(src, kwds)
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/parsers/base_parser.py", line 229, in _open_handles
    errors=kwds.get("encoding_errors", "strict"),
  File "/usr/local/lib/python3.7/dist-packages/pandas/io/common.py", line 707, in get_handle
    newline="",
FileNotFoundError: [Errno 2] No such file or directory: 'data/splits/random/labeled_sample.csv'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/wandb_run.py", line 1711, in _atexit_cleanup
    self._on_finish()
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/wandb_run.py", line 1844, in _on_finish
    self._backend.cleanup()
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/backend/backend.py", line 248, in cleanup
    self.interface.join()
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/interface/interface_shared.py", line 470, in join
    self._router.join()
  File "/usr/local/lib/python3.7/dist-packages/wandb/sdk/interface/router.py", line 99, in join
    self._thread.join()
  File "/usr/lib/python3.7/threading.py", line 1044, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.7/threading.py", line 1060, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
Exception
