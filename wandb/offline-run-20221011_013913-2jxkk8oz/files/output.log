====== evaliuate ======
epoch: 0, global step: 100
val accuarcy: 0.3446666666666667
val f_score_micro: 0.6473134708428827
val f_score_macro:0.22933958859617468
val recall: 0.5236918005768438
val precision: 0.4437415190221124
val average_precison1: 0.9300641797031681
val example_auc1: 0.9163056558363418
val macro_auc1: 0.48891552005985905
val micro_auc1: 0.8387091715080058
val ranking_loss1: 0.08369434416365824
=======================
===== best model saved! =======
epoch: 0, global step: 110, loss: 0.46683185480169725
====== evaliuate ======
epoch: 1, global step: 200
val accuarcy: 0.338
val f_score_micro: 0.6770590972545371
val f_score_macro:0.31556264389139493
val recall: 0.5995055624227441
val precision: 0.5859689536440709
val average_precison1: 0.9300641797031681
val example_auc1: 0.9163056558363418
val macro_auc1: 0.5094578994714563
val micro_auc1: 0.8404472448274387
val ranking_loss1: 0.08369434416365824
=======================
===== best model saved! =======
epoch: 1, global step: 220, loss: 0.45579728814178105
Some weights of the model checkpoint at uclanlp/visualbert-nlvr2-coco-pre were not used when initializing VisualBertModel: ['cls.predictions.decoder.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.bias', 'cls.seq_relationship.weight', 'cls.predictions.bias']
- This IS expected if you are initializing VisualBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing VisualBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 24/24 [00:11<00:00,  2.04it/s]
/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 110/110 [01:16<00:00,  1.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 24/24 [00:13<00:00,  1.83it/s]
/usr/local/lib/python3.7/dist-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 110/110 [01:22<00:00,  1.33it/s]
 54%|█████████████████████████████████████████████████████████████████████▏                                                           | 59/110 [00:33<00:28,  1.77it/s]
Traceback (most recent call last):
  File "/content/SSLMemes/src/train.py", line 288, in <module>
    step_global=global_step, epoch=epoch, val_best_score=val_best_score, processor=processor)
  File "/content/SSLMemes/src/train.py", line 64, in train
    outputs = model(**batch_inputs, labels=y)
  File "/usr/local/lib/python3.7/dist-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/content/SSLMemes/src/model.py", line 26, in forward
    loss = loss_fct(out_logits, labels.type(torch.DoubleTensor).to(out_logits.device))
KeyboardInterrupt